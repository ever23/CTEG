function TEG(){this.titulo="",this.paso=1,this.ajax={teg:{},fteg:"",dir:"",tutor:{},jurado:{},autor:{}},this.Ini("ajax/","ajax-teg.php")}TEG.prototype.Ini=function(e){this.ajax.fteg="index.php?page=teg",this.ajax.dir=e},TEG.prototype.Insertar=function(){var e=this;$(document).ready(function(){e.paso1()})},TEG.prototype.Consultar=function(e,t){var a=this;console.log(t),$().load_json(this.ajax.fteg+"::ConsultaTeg",t,function(t){var r="";if(t.error)return error("ERROR",t.error),!1;var o;for(var n in t.result)o=t.result[n],r+=" <tr class='col_hov "+(n%2?"row_act":"")+"'><td> "+o.titulo_teg+" </td><td> "+o.desc_carr+" </td><td> "+o.desc_menc+" </td><td> "+o.nom1_tutor+" "+o.ape1_tutor+"</td><td> "+o.peri_acad+"  </td><TD><a class='popup' href='?page=teg::resumen&codi_teg="+o.codi_teg+"'><div class='buscar1'></div></a>\n<a class='popup' href='?page=teg::FormEditar&codi_teg="+o.codi_teg+"'><div class='edit'></div></a></TD></tr>";0===t.num_rows?r=" <tr class='col_hov'>                <td colspan='6' align='center' class='col_select'>NO SE ENCONTRARON RESULTADOS </td>                </tr>":t.next&&(r+=" <tr class='col_hov'>                 <td colspan='6' align='center' class=''><div ><a id='Cnum' next='"+t.next[t.var]+"' >Siguente</a></div></td>                </tr>"),$(e).html(r),$("#Cnum").click(function(r){r.preventDefault();a.Consultar(e,$.extend(e,{PM1:t.next[t.var]}))})})},TEG.prototype.paso_sig=function(){this.paso++;for(var e="p"+this.paso,t=1;5>=t;t++)$(".pasos").removeClass("p"+t);$(".pasos").addClass(e)},TEG.prototype.paso_ant=function(){this.paso--;for(var e="p"+this.paso,t=1;5>=t;t++)$(".pasos").removeClass("p"+t);$(".pasos").addClass(e)},TEG.prototype.Valid_form=function(e,t,a){var r,o=($(e).serializeArray(),""),n=!0,i=new Array;a||(a=1,n=!1);for(var s=0;a>s;s++){if(r=a>1?" N&deg; "+(s+1):"",n&&(o="["+s+"]"),i.push($('input[name="ci_'+t+o+'"]').val()),!$('input[name="ci_'+t+o+'"]').ValidIdentificacion()||0===$('input[name="ci_'+t+o+'"]').val().length)return error("FORMULARIO INCOMPLETO","LA CEDULA DEL "+t.toUpperCase()+r+"  ESTA INCOMPLETA O ES INVALIDA ",function(){$('input[name="ci_'+t+o+'"]').IdentificacionInvalida()}),this.ajax[t]=[],!1;if(""===$('input[name="nom1_'+t+o+'"]').val())return error("FORMULARIO INCOMPLETO","ES NESESARIO PROPORCIONAR EL PRIMER NOMBRE  DEL "+t.toUpperCase()+r,function(){$('input[name="nom1_'+t+o+'"]').focus()}),this.ajax[t]=[],!1;if(""===$('input[name="nom2_'+t+o+'"]').val())return error("FORMULARIO INCOMPLETO","ES NESESARIO PROPORCIONAR EL SEGUNDO NOMBRE  DEL "+t.toUpperCase()+r,function(){$('input[name="nom2_'+t+o+'"]').focus()}),this.ajax[t]=[],!1;if(""===$('input[name="ape1_'+t+o+'"]').val())return error("FORMULARIO INCOMPLETO","ES NESESARIO PROPORCIONAR EL PRIMER APELLIDO  DEL "+t.toUpperCase()+r,function(){$('input[name="ape1_'+t+o+'"]').focus()}),this.ajax[t]=[],!1;if($('input[name="emai_'+t+o+'"]').val().length>0&&(-1===$('input[name="emai_'+t+o+'"]').val().indexOf("@")||-1===$('input[name="emai_'+t+o+'"]').val().indexOf(".")))return error("FORMULARIO INCOMPLETO","EL CORREO ELECTRONICO DEL "+t.toUpperCase()+r+" ES INVALIDO",function(){$('input[name="emai_'+t+o+'"]').focus()}),this.ajax[t]=[],!1;if($('input[name="telf_'+t+o+'"]').val().length>0&&!$('input[name="telf_'+t+o+'"]').ValidTelefono())return error("FORMULARIO INCOMPLETO","EL NUMERO DE TELEFONO  DEL "+t.toUpperCase()+r+" ES INVALIDO",function(){$('input[name="telf_'+t+o+'"]').focus()}),this.ajax[t]=[],!1}for(var s=0;s<i.length;s++)if(i.indexOf(i[s])!=i.lastIndexOf(i[s]))return error("FORMULARIO INCOMPLETO","LA CEDULA DEL "+t.toUpperCase()+" N&deg; "+(Number(i.indexOf(i[s]))+1)+"  Y DEL N&deg; "+(Number(i.lastIndexOf(i[s]))+1)+" NO PUEDEN SER IDENTICAS "),this.ajax[t]=[],!1;return!0},TEG.prototype.form_object=function(e,t){var a=new Object;for(a["ci_"+e]=[],a["nom1_"+e]=[],a["nom2_"+e]=[],a["ape1_"+e]=[],a["ape2_"+e]=[],a["emai_"+e]=[],a["telf_"+e]=[],i=0;t>i;i++)a["ci_"+e].push($("#ci_"+e+i).val()),a["nom1_"+e].push($("#nom1_"+e+i).val()),a["nom2_"+e].push($("#nom2_"+e+i).val()),a["ape1_"+e].push($("#ape1_"+e+i).val()),a["ape2_"+e].push($("#ape2_"+e+i).val()),a["emai_"+e].push($("#emai_"+e+i).val()),a["telf_"+e].push($("#telf_"+e+i).val());return a},TEG.prototype.rellenar_form=function(e){var t,a=this.ajax[e]["ci_"+e].length;for(i=0;a>i;i++)t=this.ajax[e],$("#ci_"+e+i).val(this.ajax[e]["ci_"+e][i]),$("#nom1_"+e+i).val(this.ajax[e]["nom1_"+e][i]),$("#nom2_"+e+i).val(this.ajax[e]["nom2_"+e][i]),$("#ape1_"+e+i).val(this.ajax[e]["ape1_"+e][i]),$("#ape2_"+e+i).val(this.ajax[e]["ape2_"+e][i]),$("#emai_"+e+i).val(this.ajax[e]["emai_"+e][i]),$("#telf_"+e+i).val(this.ajax[e]["telf_"+e][i])},TEG.prototype.exist=function(e,t){for(var a=this,r=0;t>r;r++)$("#ci_"+e+r).focusout(function(){var r=$(this).attr("id"),o=r.substr(r.length-1,r.length-1),n=$(this).val();$().load_json(a.ajax.fteg+"::BuscarTform",{ci_b:n,tform:e},function(a){if(a.error)return error("ERROR EN EL SERVIDOR",a.error),!1;var r={};a.num_rows>0&&(r=a.result[0],$("#nom1_"+e+o).val(r["nom1_"+e]),$("#nom2_"+e+o).val(r["nom2_"+e]),$("#ape1_"+e+o).val(r["ape1_"+e]),$("#ape2_"+e+o).val(r["ape2_"+e]),$("#emai_"+e+o).val(r["emai_"+e]),$("#telf_"+e+o).val(r["telf_"+e]),$("#errores:ui-dialog").dialog("destroy"),$("#errores").dialog("close"),$("#errores").attr("title",""),$("#error_div").html("EL "+e.toUpperCase()+" "+(Number(t)>1?"N&deg; "+(Number(o)+1):"")+" YA SE ENCUENTRA EN LA BASE DE DATOS, EL FORMULARIO SE LLENARA CON LOS DATOS DISPONIBLES  "),$("#errores").dialog({height:300,width:300,modal:!0,buttons:{ENTENDIDO:function(){$("#errores").dialog("close")}}}))})})},TEG.prototype.fmt_form=function(){$("input[type=tel]").FmtTelefono(),$(".ci").FmtIdentificacion("C.I-")},TEG.prototype.paso1=function(){var e=this;$("#verif_teg").click(function(){var t=$("input[name=titulo_teg]").val();$("#coin").load_json(e.ajax.fteg+"::verificate",{titulo_teg:t,verificate:!0},function(e){if(e.error)return error("ERROR EN EL SERVIDOR",e.error),!1;for(var t=" ",a={},r=0;a=e.result[r];r++)t+='<tr class="'+(r%2?"row_act":"")+'"><td>'+a.titulo_teg+"</td></tr>";return 0==e.num_rows&&(t+='<tr><td  align="center" class="col_select"> NO SE ENCONTRARON COINCIDENCIAS </td></tr>'),t})}),$("#SIGIENTE").click(function(){e.titulo=$("input[name=titulo_teg]").val(),e.paso1_2()})},TEG.prototype.paso1_2=function(){var e=this,t=' <div align="center"><H2>INGRESA LA CANTIDAD DE AUTORES DE <BR>'+e.titulo+' </H2><input type="number" name="c_atores" class="input_text" min="1" ><br><button class="submit" type="submit"  id="regresar" name=""  value="">REGRESAR</button><button class="submit" type="submit"id="bc_atores" name="bc_atores"  value="">ENVIAR</button></div><br>';e.paso_sig(),$(".formularios").html(t),$("#regresar").click(function(t){t.preventDefault(),e.b_regresar("1")}),$("#bc_atores").click(function(){var t=Number($("input[name=c_atores]").val());1>t?error("ERROR","LA CANTIDAD NO PUEDE SER MENOR A 0"):$().load_html(e.ajax.fteg+"::XMLHttpRequest",{cant:t,request:"form-autor"},function(a){$(".formularios").html(a),e.paso2(t)})})},TEG.prototype.paso2=function(e){var t=this;$("#regresar").click(function(e){e.preventDefault(),t.b_regresar("1_2")}),t.fmt_form(),t.exist("autor",e),$("#autores").click(function(a){a.preventDefault(),t.ajax.autor=t.form_object("autor",e),t.Valid_form("#form_autor","autor",e)&&$().load_html(t.ajax.fteg+"::XMLHttpRequest",{request:"form-tutor"},function(e){$(".formularios").html(e),t.paso3()})})},TEG.prototype.paso3=function(){var e=this;$("#regresar").click(function(t){t.preventDefault(),e.b_regresar("2")}),e.paso_sig(),e.fmt_form(),e.exist("tutor",1),$("#tutores").click(function(t){t.preventDefault(),e.ajax.tutor=e.form_object("tutor",1),e.Valid_form("#form_tutor","tutor",!1)&&e.paso3_4()})},TEG.prototype.paso3_4=function(){var e=this;e.paso_sig();var t=' <div align="center"><H2>INGRESA LA CANTIDAD DE JURADOS DE <BR>'+e.titulo+' </H2><input type="number" name="c_jurados" class="input_text" min="1"><br><button class="submit" type="submit"  id="regresar" name=""  value="">REGRESAR</button><button class="submit" type="submit"  id="bc_jurados" name="bc_jurados"  value="">ENVIAR</button></div><br>';$(".formularios").html(t),$("#regresar").click(function(t){t.preventDefault(),e.b_regresar("3")}),$("#bc_jurados").click(function(){var t=Number($("input[name=c_jurados]").val());1>t?error("ERROR","LA CANTIDAD NO PUEDE SER MENOR A 0"):$(".formularios").load_html(e.ajax.fteg+"::XMLHttpRequest",{cant:t,request:"form-jurado"},function(a){$(".formularios").html(a),e.paso4(t)})})},TEG.prototype.paso4=function(e){var t=this;$("#regresar").click(function(e){e.preventDefault(),t.b_regresar("3_4")}),t.fmt_form(),t.exist("jurado",e),$("#jurados").click(function(a){a.preventDefault(),t.ajax.jurado=t.form_object("jurado",e),t.Valid_form("#form_jurado","jurado",e)&&$(".formularios").load_html(t.ajax.fteg+"::XMLHttpRequest",{request:"CargarPdf"},function(a){$(".formularios").html(a),t.paso5(e)})})},TEG.prototype.paso5=function(){var e=this;e.paso_sig(),$("#regresar").click(function(t){t.preventDefault(),e.b_regresar("4")}),$("button[name=cargar_pdf]").click(function(t){t.preventDefault(),$(".formularios").load_html(e.ajax.fteg+"::XMLHttpRequest",{titulo:e.titulo,request:"form-teg"},function(t){$(".formularios").html(t),e.paso6()}),t.preventDefault()});var t=$('<iframe id="iframe" width="600" height="600" src="" ></iframe>');$("input[name=TegPdf]").change(function(a){a.preventDefault();var r=new FormData($("#FormTegPdf")[0]);$("").load_json("?page=teg::CargarPdf",r,function(a){a.error?error("ERROR",a.error):(e.ajax.pdf_name=a.pdf_name,t.attr("src","?page=teg::PreviewPdf&pdf_name="+a.pdf_name),$("#PreviewPdf").html(t))},{contentType:!1,processData:!1})})},TEG.prototype.ValidateTEG=function(){return console.log($("select[name=codi_carr]").val()),""===$("select[name=codi_carr]").val()||void 0===$("select[name=codi_carr]").val()?(error("ERROR","PORFAVOR SELECCIONE UNA CARRERA "),!1):""===$("select[name=peri_acad]").val()||void 0===$("select[name=peri_acad]").val()?(error("ERROR","PORFAVOR SELECCIONE UN PERIODO ACADEMICO "),!1):""===$("select[name=codi_menc]").val()||void 0===$("select[name=codi_menc]").val()?(error("ERROR","PORFAVOR SELECCIONE UNA MENCION "),!1):!0},TEG.prototype.paso6=function(){var e=this;e.paso_sig(),$("#regresar").click(function(t){t.preventDefault(),e.b_regresar("5")}),$("input[name=titulo_teg]").val(e.titulo),$("#teg").click(function(t){if(t.preventDefault(),e.ValidateTEG()){e.ajax.teg={titulo_teg:e.titulo,codi_carr:$("select[name=codi_carr]").val(),peri_acad:$("select[name=peri_acad]").val(),codi_menc:$("select[name=codi_menc]").val(),obse_teg:$("textarea[name=obse_teg]").val(),pdf_name:e.ajax.pdf_name};var a=$.extend(e.ajax.teg,e.ajax.autor,e.ajax.tutor,e.ajax.jurado,{request:"verificar-teg"});$().load_html(e.ajax.fteg+"::XMLHttpRequest",a,function(t){$(".formularios").html(t),e.registrar_teg()})}})},TEG.prototype.registrar_teg=function(){var e=this;$("#regresar").click(function(t){t.preventDefault(),e.b_regresar("6")}),$("#registrar").click(function(){var t=$.extend(e.ajax.teg,e.ajax.autor,e.ajax.tutor,e.ajax.jurado);$().load_json(e.ajax.fteg+"::Guardar",t,function(t){return t.error?(error("ERROR EN EL SERVIDOR",t.error),!1):($("#errores:ui-dialog").dialog("destroy"),$("#errores").dialog("close"),$("#errores").attr("title","<H2></H2>"),$("#error_div").html("EL TRABAJO ESPECIAL DE GRADO <br>"+e.titulo.toUpperCase()+"<br>FUE GUARDADO"),$("#errores").dialog({height:300,width:300,modal:!0,buttons:{LISTO:function(){$("#errores").dialog("close"),window.location="?page=teg&codi_teg="+t.codi_teg}}}),void 0)})})},TEG.prototype.b_regresar=function(e){var t=this;switch(e){case"1":window.location="?page=teg::insertar&titulo="+t.titulo;break;case"1_2":t.paso_ant(),t.paso1_2();break;case"2":$().load_html(t.ajax.fteg+"::XMLHttpRequest",{request:"form-autor",cant:t.ajax.autor.ci_autor.length},function(e){$(".formularios").html(e),t.paso_ant(),t.rellenar_form("autor"),t.paso2(t.ajax.autor.ci_autor.length)});break;case"3":$().load_html(t.ajax.fteg+"::XMLHttpRequest",{request:"form-tutor"},function(e){$(".formularios").html(e),t.paso_ant(),t.rellenar_form("tutor"),t.paso3()});break;case"3_4":t.paso_ant(),t.paso3_4();break;case"4":$(".formularios").load_html(t.ajax.fteg+"::XMLHttpRequest",{request:"form-jurado",cant:t.ajax.jurado.ci_jurado.length},function(e){$(".formularios").html(e),t.paso_ant(),t.rellenar_form("jurado"),t.paso4(t.ajax.jurado.ci_jurado.length)});break;case"5":$(".formularios").load_html(t.ajax.fteg+"::XMLHttpRequest",{request:"CargarPdf"},function(e){$(".formularios").html(e),t.paso_ant(),t.paso5(),$("#PreviewPdf").html('<iframe id="iframe" width="600" height="600" src="?page=teg::PreviewPdf&pdf_name='+t.ajax.pdf_name+'" ></iframe>')});break;case"6":$().load_html(t.ajax.fteg+"::XMLHttpRequest",{request:"form-teg",titulo:t.titulo},function(e){$(".formularios").html(e),t.paso_ant(),t.paso6(),$("select[name=codi_carr]> option[value="+t.ajax.teg.codi_carr+"]").attr("selected",""),$("select[name=peri_acad] > option[value="+t.ajax.teg.peri_acad+"]").attr("selected",""),$("select[name=codi_menc]> option[value="+t.ajax.teg.codi_menc+"]").attr("selected",""),$("textarea[name=obse_teg]").val(t.ajax.teg.obse_teg)})}};